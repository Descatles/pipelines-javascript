# Node.js
# Build a general Node.js project with npm.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

# trigger:
# - master

# pool:
#   vmImage: 'ubuntu-latest'

# steps:
# - task: NodeTool@0
#   inputs:
#     versionSpec: '10.x'
#   displayName: 'Install Node.js'

# - script: |
#     npm install
#     npm run build
#   displayName: 'npm install and build'

trigger:
- master

jobs:
- job: Get_Repos
  displayName: Get_Repos
  pool:
    vmImage: 'Ubuntu 18.04'
  steps:
  - powershell: 'node scripts/filterSDK.js'
    name: setvarStep
  - script: echo $(setvarStep.enabled_jobs)
    name: echovar
- job: AzureSdkForNet
  dependsOn: Get_Repos
  variables:
    enabled_jobs: $[ dependencies.Get_Repos.outputs['setvarStep.enabled_jobs'] ]
  condition: containsValue(dependencies.Get_Repos.outputs['setvarStep.enabled_jobs'], 'azure-sdk-for-net')
  displayName: AzureSdkForNet
  steps:
  - script: echo $(enabled_jobs)
- job: AzureSdkForJava
  dependsOn: Get_Repos
  variables:
    enabled_jobs: $[ dependencies.Get_Repos.outputs['setvarStep.enabled_jobs'] ]
  condition: containsValue(variables.enabled_jobs, 'azure-sdk-for-java')
  displayName: AzureSdkForJava
  steps:
  - script: echo $(enabled_jobs)
- job: AzureSdkForJs
  dependsOn: Get_Repos
  variables:
    enabled_jobs: $[ dependencies.Get_Repos.outputs['setvarStep.enabled_jobs'] ]
  condition: containsValue(variables.enabled_jobs, 'azure-sdk-for-js')
  displayName: AzureSdkForJs
  steps:
  - script: echo $(enabled_jobs)
- job: AzureSdkForPython
  dependsOn: Get_Repos
  variables:
    enabled_jobs: $[ dependencies.Get_Repos.outputs['setvarStep.enabled_jobs'] ]
  condition: containsValue(variables.enabled_jobs, 'azure-sdk-for-python')
  displayName: AzureSdkForPython
  steps:
  - script: echo $(enabled_jobs)
